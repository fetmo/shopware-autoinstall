// {namespace name=backend/viison_pickware_erp_index_news_widget/main}
Ext.define("Shopware.apps.ViisonPickwareERPIndexNewsWidget.view.Main",{ extend:"Shopware.apps.Index.view.widgets.Base",alias:"widget.viison-pickware-erp-news-widget",title:'{s name=panel/title}{/s}',layout:"fit",bodyPadding:"8 8",initComponent:function(){ this.newsStore=Ext.create("Shopware.apps.ViisonPickwareERPIndexNewsWidget.store.News");this.items=[this.createNewsGrid()];this.tools=[{ type:"refresh",scope:this,handler:function(){ this.newsStore.load()}}];this.callParent(arguments)},createNewsGrid:function(){ return Ext.create("Ext.grid.Panel",{ border:0,store:this.newsStore,columns:[{ dataIndex:"title",header:'{s name=panel/columns/title}{/s}',flex:2},{ dataIndex:"date",header:'{s name=panel/columns/date}{/s}',flex:1,renderer:Ext.util.Format.dateRenderer()}],listeners:{ scope:this,itemclick:function(e,i){ window.open(i.data.link,"_blank");e.getSelectionModel().deselectAll();this.setVisited(i.data.linkHash);i.set("visited",true);e.refresh()}},viewConfig:{ getRowClass:function(e){ return e.get("visited")?"x-widget-viison-pickware-erp-index-news-widget-visited":"x-widget-viison-pickware-erp-index-news-widget-unvisited"}}})},setVisited:function(e){ var i=window.localStorage.getItem("viison_pickware_erp_index_news_widget-news_cache");var t=Ext.decode(i)||{ };if(t[e]){ return}t[e]=true;window.localStorage.setItem("viison_pickware_erp_index_news_widget-news_cache",Ext.encode(t))}});
