// {namespace name=backend/viison_pickware_erp_order_cancelation/main}
Ext.define("Shopware.apps.ViisonPickwareERPOrderCancelation.view.detail.Position",{ override:"Shopware.apps.Order.view.detail.Position",initComponent:function(){ this.callParent(arguments);this.wrapPositionGrid()},createGridToolbar:function(){ var t=this.callParent(arguments);t.add(Ext.create("Ext.button.Button",{ iconCls:"sprite-blue-document--minus",text:'{s name=detail/position/toolbar/button/cancel_positions}{/s}',action:"cancelPositions",disabled:this.record.get("invoiceShipping")<=0,scope:this,handler:function(){ this.fireEvent("cancelPositions",this)}}));return t},getGridSelModel:function(){ var t=this.callParent(arguments);t.on("selectionchange",function(t,i){ var e=this.record.get("invoiceShipping")<=0;if(e){ Ext.each(i,function(t){ if(t.get("quantity")>0){ e=false;return false}return undefined})}this.down("button[action=cancelPositions]").setDisabled(e)},this);return t},wrapPositionGrid:function(){ var t=-1;var i;this.items.each(function(e,n){ if(e.name==="order-position-grid"){ t=n;i=e;return false}return undefined});var e=Ext.create("Ext.container.Container",{ layout:"fit",border:0,flex:1,items:[i]});var n=Ext.create("Ext.container.Container",{ layout:{ type:"vbox",align:"stretch",pack:"start"},border:0,items:[e,{ xtype:"viison_pickware_erp_order_cancelation-detail-position-canceled_position_grid",columns:this.getCanceledPositionGridColumns(i),store:i.store,statusStore:i.statusStore,taxStore:i.taxStore,flex:1}]});this.remove(i);this.insert(t,n)},getCanceledPositionGridColumns:function(t){ var i=this.getColumns(t);var e=[];Ext.each(i,function(t,i){ if(t.xtype==="actioncolumn"){ e.push(i)}});var n=0;Ext.each(e,function(t){ i.splice(t-n,1);n+=1});Ext.each(i,function(t){ if(t.dataIndex==="quantity"){ t.dataIndex="viisonCanceledQuantity"}else{ delete t.editor}if(t.dataIndex==="total"){ t.dataIndex="viisonCanceledTotal"}});return i}});
