Ext.define("Shopware.apps.ViisonCommonPaginationToolbar.view.Toolbar",{ extend:"Ext.toolbar.Paging",alias:"widget.viison_common_pagination_toolbar-toolbar",cls:"viison_common_pagination_toolbar-toolbar",mixins:["Shopware.apps.ViisonCommonApp.Mixin"],dock:"bottom",displayInfo:true,fallbackPageSize:100,paginationSteps:[50,100,250,500],viisonSnippetNamespace:"backend/viison_common_pagination_toolbar/main",constructor:function(){ this.subject=this.getViisonSnippet("subject");this.callParent(arguments)},initComponent:function(){ this.callParent();this.paginationSteps=this.paginationSteps.slice();this.ensurePaginationStepsContainDefaultPagesize();if(this.shouldAddPageSizeSelection()){ this.addPageSizeSelection()}},ensurePaginationStepsContainDefaultPagesize:function(){ var t=this.paginationSteps&&this.paginationSteps.indexOf(this.getDefaultPageSize())!==-1;if(!t){ if(!this.paginationSteps){ this.paginationSteps=[]}else{ this.paginationSteps.push(this.getDefaultPageSize())}}},shouldAddPageSizeSelection:function(){ return this.paginationSteps&&this.paginationSteps.length>1},getDefaultPageSize:function(){ return this.store.pageSize||(this.paginationSteps?this.paginationSteps[0]:undefined)||this.fallbackPageSize},addPageSizeSelection:function(){ var t=Ext.create("Ext.form.field.ComboBox",{ width:186,labelWidth:120,fieldLabel:this.subject+" "+this.getViisonSnippet("subjects_per_page"),cls:Ext.baseCSSPrefix+"page-size",displayField:"value",valueField:"value",queryMode:"local",store:this.getPaginationStore()});this.add("->",t,{ xtype:"tbspacer",width:6});t.setValue(this.getDefaultPageSize());t.on("change",this.onChangePageSize,this)},getPaginationStore:function(){ var t=this.paginationSteps.sort(function(t,i){ return t-i});return Ext.create("Ext.data.Store",{ fields:["value"],data:Ext.Array.map(t,function(t){ return{ value:t}})})},onChangePageSize:function(t,i){ this.store.pageSize=i||this.getDefaultPageSize();this.store.currentPage=1;this.store.load()}});
