Ext.define("Shopware.apps.ViisonPickwareERPWarehouseManagement.controller.BinLocationCreation",{ extend:"Ext.app.Controller",mixins:["Shopware.apps.ViisonCommonApp.Mixin"],viisonSnippetNamespace:"backend/viison_pickware_erp_warehouse_management/main",init:function(){ this.control({ "viison_pickware_erp_warehouse_management-edit-bin_locations-bin_location_creation button[action=save]":{ click:this.onSave},"viison_pickware_erp_warehouse_management-edit-bin_locations-bin_location_creation button[action=cancel]":{ click:this.onCancel}});this.callParent(arguments)},createWindow:function(e,i,n){ Ext.create("Shopware.apps.ViisonPickwareERPWarehouseManagement.view.edit.BinLocations.BinLocationCreation",{ warehouse:e,binLocationStore:i,saveCallback:n||Ext.emptyFn}).show()},onSave:function(e){ var i=e.up("viison_pickware_erp_warehouse_management-edit-bin_locations-bin_location_creation");var n=i.down("form").getForm();if(!n.isValid()){ return}var o=n.getValues().code;var a=Ext.create("Shopware.apps.ViisonPickwareERPWarehouseManagement.model.BinLocation",{ });a.set("code",o);a.set("warehouseId",i.warehouse.get("id"));i.setLoading(true);i.binLocationStore.add(a);i.binLocationStore.sync({ scope:this,callback:function(e){ i.setLoading(false);var n=e.operations[0];if(n.success){ i.close();var a=Ext.String.format(this.getViisonSnippet("notification/success/create_bin_location/message"),o);Shopware.Notification.createGrowlMessage(this.getViisonSnippet("notification/success/create_bin_location/title"),a,"ViisonPickwareERP")}else{ i.binLocationStore.rejectChanges();var t=n.request.proxy.reader.jsonData.uniqueConstraintViolation;var r=t?this.getViisonSnippet("notification/error/message/create_bin_location/duplicate_location"):this.getViisonSnippet("notification/error/message/create_bin_location/unknown_error");r=Ext.String.format(r,o);Shopware.Notification.createGrowlMessage(this.getViisonSnippet("notification/error/title"),r,"ViisonPickwareERP")}}})},onCancel:function(e){ e.up("viison_pickware_erp_warehouse_management-edit-bin_locations-bin_location_creation").close()}});
