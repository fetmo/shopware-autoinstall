// {namespace name=backend/viison_pickware_erp_index_plugin_test_check/main}
Ext.define("Shopware.apps.ViisonPickwareERPIndexPluginTestCheck.view.Menu",{ override:"Shopware.apps.Index.view.Menu",initComponent:function(){ this.on("menu-created",function(){ window.setTimeout(function(){ this.performPluginTestCheck()}.bind(this),500)},this);this.callParent(arguments)},performPluginTestCheck:function(){ Ext.Ajax.request({ url:'{url controller=ViisonPickwareERPIndexPluginTestCheck action=checkLicense}',success:function(i){ var e=Ext.JSON.decode(i.responseText,true);if(!e||!e.pluginTestStatus||e.pluginTestStatus.daysLeft>14){ return}var t=e.pluginTestStatus.daysLeft<0?'{s name=notification/message/test_expired}{/s}':'{s name=notification/message/test_expires_soon}{/s}';Shopware.Notification.createStickyGrowlMessage({ title:'{s name=notification/title}{/s}',text:Ext.String.format(t,Math.abs(e.pluginTestStatus.daysLeft)),btnDetail:{ text:'{s name=notification/buttons/more_info}{/s}',link:"https://www.pickware.de/starten/mit-pickware-direkt-starten"}})}})}});
