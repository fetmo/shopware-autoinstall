// {namespace name=backend/viison_pickware_erp_order_status_based_position_update/main}
Ext.define("Shopware.apps.ViisonPickwareERPOrderStatusBasedPositionUpdate.controller.List",{ override:"Shopware.apps.Order.controller.List",skipAlert:false,onSaveOrder:function(i,e,s){ var t=s.getAt(e.rowIdx);var l=e.originalValues.status;var a=e.newValues.status;if(!this.skipAlert&&l!==a&&(a===4||a===7)){ var r=a===4?'{s name=alert/single/message/cancelled}{/s}':'{s name=alert/single/message/completely_shipped}{/s}';ViisonPickwareBinLocationSelectionAlert.selectWarehouse('{s name=alert/title}{/s}',r,Ext.Msg.YESNO,function(l,r){ if(l==="yes"){ if(a===4){ t.viisonPickwareERPcancelShippingCosts()}t.getPositions().each(function(i){ if(a===4){ i.cancelEntirely();i.commit()}else if(a===7){ i.set("shipped",i.get("quantity"))}});t.getProxy().extraParams=t.getProxy().extraParams||{ };t.getProxy().extraParams.warehouseId=r.get("id")}this.skipAlert=true;this.onSaveOrder(i,e,s)},this)}else{ this.skipAlert=false;this.callParent(arguments)}}});
