// {namespace name=backend/viison_pickware_erp_order_status_based_position_update/main}
Ext.define("Shopware.apps.ViisonPickwareERPOrderStatusBasedPositionUpdate.controller.Batch",{ override:"Shopware.apps.Order.controller.Batch",skipAlert:false,onProcessChanges:function(i,e){ var s=i.getValues().orderStatus;if(!this.skipAlert&&(s===4||s===7)){ var t=s===4?'{s name=alert/batch/message/cancelled}{/s}':'{s name=alert/batch/message/completely_shipped}{/s}';ViisonPickwareBinLocationSelectionAlert.selectWarehouse('{s name=alert/title}{/s}',t,Ext.Msg.YESNO,function(t,c){ if(t==="yes"){ if(s===4){ Ext.each(i.records,function(i){ i.viisonPickwareERPcancelShippingCosts();i.getPositions().each(function(i){ i.cancelEntirely();i.commit()})})}else if(s===7){ Ext.each(i.records,function(i){ i.getPositions().each(function(i){ i.set("shipped",i.get("quantity"))})})}ViisonPickwareERPOrderEventBus.on("collectBatchStoreParams",function(i){ i.getProxy().extraParams.warehouseId=c.get("id")},this,{ single:true})}this.skipAlert=true;this.onProcessChanges(i,e)},this)}else{ this.skipAlert=false;this.callParent(arguments)}}});
