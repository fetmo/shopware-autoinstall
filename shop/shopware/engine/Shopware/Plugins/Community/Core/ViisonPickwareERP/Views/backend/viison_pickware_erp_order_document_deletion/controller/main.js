// {namespace name=backend/viison_pickware_erp_order_document_deletion/main}
Ext.define("Shopware.apps.ViisonPickwareERPOrderDocumentDeletion.controller.Detail",{ override:"Shopware.apps.Order.controller.Detail",init:function(){ this.callParent(arguments);this.control({ "order-document-list":{ deleteDocument:this.onDeleteDocument}})},onDeleteDocument:function(e,i,I){ var S=i.getDocType().getAt(0).get("name")+" "+i.get("documentId");if(I!==true){ var l='{s name=alert/confirm_deletion/title}{/s}';var t=Ext.String.format('{s name=alert/confirm_deletion/text}{/s}',S);Ext.Msg.confirm(l,t,function(I){ if(I==="yes"){ this.onDeleteDocument(e,i,true)}},this);return}e.setLoading(true);Ext.Ajax.request({ method:"POST",url:'{url controller=ViisonPickwareERPOrderDocumentDeletion action=deleteDocument}',params:{ documentId:i.get("id")},callback:function(I,l,t){ e.setLoading(false);var F=Ext.JSON.decode(t.responseText);if(F&&F.success){ e.getStore().remove(i);var O='{s name=notification/success/title}{/s}';var T=Ext.String.format('{s name=notification/success/message}{/s}',S);Shopware.Msg.createGrowlMessage(O,T,"Pickware")}else{ Shopware.Msg.createGrowlMessage('{s name=notification/failure/title}{/s}','{s name=notification/failure/message}{/s}',"Pickware")}}})}});
